cmssw_setup:
  image: gitlab-registry.cern.ch/eos/gitlab-eos/cc7:latest
  tags:
    - cvmfs
  variables:
    # This is also set on LXPLUS
    CMS_PATH: /cvmfs/cms.cern.ch
    CMT_CERN_USER: jleonhol
  script:
    # IMPORTANT: Expand aliases in noninteractive bash mode
    # Otherwise cmsrel and cmsenv won't work
    - shopt -s expand_aliases
    - yum install -y python3
    # access CVMFS
    - set +u && source ${CMS_PATH}/cmsset_default.sh; set -u
    - set +u && source setup.sh set -u
    - cd docs
    - make html
      # - cp -r build/* /eos/home-j/jleonhol/www/testsphinx 

docs:
    image: gitlab-registry.cern.ch/eos/gitlab-eos/cc7:latest
    tags:
      - docker-privileged
    script:
      - automount
      - echo "$USERPASS" | kinit username
      - eosfusebind
